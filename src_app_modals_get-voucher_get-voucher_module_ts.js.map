{"version":3,"file":"src_app_modals_get-voucher_get-voucher_module_ts.js","mappings":"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","sources":["./src/app/helper/pagination.helper.ts","./src/app/helper/parse.helper.ts","./src/app/modals/get-voucher/get-voucher-routing.module.ts","./src/app/modals/get-voucher/get-voucher.module.ts","./src/app/modals/get-voucher/get-voucher.page.ts","./src/app/service/voucher.service.ts","./src/app/store/chart.store.ts","./src/app/store/voucher.store.ts","./src/app/store/voucherRequest.store.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\r\n\r\n\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\n\r\nexport class PaginationHelper {\r\n    constructor() {\r\n    }\r\n\r\n  static async loadData(event, service: any, store: any, limit) {\r\n        try {\r\n            if (store.shouldLoadMore){\r\n                const result = await service.loadMore();\r\n                event.target.complete();\r\n                store.incrementPage();\r\n                if (result.length < limit) {\r\n                    store.setShouldLoadMore(false);\r\n                    event.target.disabled = true;\r\n                }\r\n            }else{\r\n                event.target.disabled = true;\r\n            }\r\n        }catch (e) {\r\n            console.log('Error:', e);\r\n        }\r\n    }\r\n  static async checkExisting(newEl, arr){\r\n        try {\r\n            const resultArray = arr.filter((item) => item.objectId === newEl.objectId);\r\n            if ( resultArray.length > 0){\r\n                return true;\r\n            }\r\n            return false;\r\n\r\n        }catch (e) {\r\n            console.log('Error:',e);\r\n        }\r\n    }\r\n}\r\n\r\n","import {Injectable} from '@angular/core';\r\nimport * as Parse from 'parse';\r\n\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\n\r\nexport class ParseHelper {\r\n    constructor() {\r\n    }\r\n\r\n    static arrayToJSON(parseArray: Parse.Object[]): any[]{\r\n      const jsonArray: any[] = [];\r\n      for(const parseObject of parseArray){\r\n        jsonArray.push(parseObject.toJSON());\r\n      }\r\n      return jsonArray;\r\n    }\r\n    static getParseObjectWithoutData(className: string, id: string): Parse.Object {\r\n    try {\r\n      const ObjectTable = Parse.Object.extend(className);\r\n      const object = ObjectTable.createWithoutData(id);\r\n      return object;\r\n    } catch (e) {\r\n      console.log('Error: ', e);\r\n      return null;\r\n    }\r\n\r\n\r\n  }\r\n}\r\n\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { GetVoucherPage } from './get-voucher.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: GetVoucherPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class GetVoucherPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { GetVoucherPageRoutingModule } from './get-voucher-routing.module';\r\n\r\nimport { GetVoucherPage } from './get-voucher.page';\r\nimport {SharedModule} from \"../../module/shared.module\";\r\n\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        IonicModule,\r\n        GetVoucherPageRoutingModule,\r\n        SharedModule\r\n    ],\r\n  declarations: [GetVoucherPage]\r\n})\r\nexport class GetVoucherPageModule {}\r\n","import {Component, OnInit} from '@angular/core';\r\nimport VoucherStore from '../../store/voucher.store';\r\nimport {ModalController} from '@ionic/angular';\r\nimport {IUser} from '../../model/user.model';\r\n\r\nimport * as Parse from 'parse';\r\nimport {IVoucher, IVoucherRequest, IVoucherRequestParse} from '../../model/voucher.model';\r\nimport {ParseHelper} from '../../helper/parse.helper';\r\nimport {VoucherService} from '../../service/voucher.service';\r\nimport {UserStore} from \"../../store/user.store\";\r\nimport VoucherBrandStore from \"../../store/voucherBrand.store\";\r\n\r\n@Component({\r\n  selector: 'app-get-voucher',\r\n  templateUrl: './get-voucher.page.html',\r\n  styleUrls: ['./get-voucher.page.scss'],\r\n})\r\nexport class GetVoucherPage implements OnInit {\r\n  uploaded: boolean;\r\n  user: IUser;\r\n  vouchers: IVoucher[];\r\n  step = 0;\r\n\r\n  constructor(public voucherBrandStore: VoucherBrandStore, public userStore: UserStore, public voucherStore: VoucherStore, private modalController: ModalController, private voucherService: VoucherService) {\r\n    this.user = Parse.User.current().toJSON() as unknown as IUser;\r\n    this.vouchers = this.voucherStore.vouchers.filter(v=>v.brand.objectId===this.voucherBrandStore.selectedVoucherBrand.objectId);\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  selectVoucher(voucher: IVoucher){\r\n    this.voucherStore.setSelectedVoucher(voucher);\r\n    this.step++;\r\n  }\r\n\r\n  async requestVoucher() {\r\n    try {\r\n      this.uploaded = false;\r\n\r\n\r\n      const voucher: Parse.Object = await ParseHelper.getParseObjectWithoutData('Voucher', this.voucherStore.selectedVoucher.objectId);\r\n      // const voucherRequest: IVoucherRequestParse = {\r\n      //   voucher,\r\n      //   user: Parse.User.current()\r\n      // };\r\n\r\n      const voucherRequest: IVoucherRequest = {\r\n        voucher: this.voucherStore.selectedVoucher,\r\n      };\r\n\r\n      await this.voucherService.requestVoucher(voucherRequest);\r\n      const delay = ms => new Promise(res => setTimeout(res, ms));\r\n      await delay(1000);\r\n      this.uploaded = true;\r\n\r\n      await this.closeModal();\r\n      // this.user =\r\n    } catch (e) {\r\n      const delay = ms => new Promise(res => setTimeout(res, ms));\r\n      await delay(1000);\r\n      this.uploaded = true;\r\n      console.log('Error:', e);\r\n    }\r\n  }\r\n\r\n  async closeModal() {\r\n    await this.modalController.dismiss();\r\n  }\r\n\r\n  previousPage() {\r\n    if(this.step!==0){\r\n      this.step--;\r\n    }\r\n  }\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport * as Parse from 'parse';\r\nimport VoucherStore from '../store/voucher.store';\r\nimport {ParseHelper} from '../helper/parse.helper';\r\nimport {IVoucher, IVoucherRequest, IVoucherRequestParse} from '../model/voucher.model';\r\nimport {UserStore} from \"../store/user.store\";\r\nimport {PaginationHelper} from \"../helper/pagination.helper\";\r\nimport ChartStore from \"../store/chart.store\";\r\nimport VoucherRequestStore from \"../store/voucherRequest.store\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class VoucherService {\r\n\r\n  constructor(private voucherRequestStore: VoucherRequestStore, private voucherStore: VoucherStore, private userStore: UserStore, private chartStore: ChartStore) {\r\n  }\r\n\r\n\r\n  async getSpecificVouchers(brandID: string) {\r\n    try {\r\n      // const query = new Parse.Query('Voucher');\r\n      // const results: any[] = await query.\r\n    } catch (e) {\r\n      console.log('Error: ', e);\r\n    }\r\n  }\r\n\r\n  async getAllVouchers() {\r\n    try {\r\n      const query = new Parse.Query('Voucher');\r\n      const results: any[] = await query.include('brand').findAll();\r\n      const vouchers: IVoucher[] = ParseHelper.arrayToJSON(results);\r\n      console.log('Got vouchers: ', vouchers);\r\n      for (let el of vouchers) {\r\n        if (!await PaginationHelper.checkExisting(el, this.voucherStore.vouchers)) {\r\n          this.voucherStore.addVoucher(el);\r\n        }\r\n      }\r\n      // await this.voucherStore.setVouchers(vouchers);\r\n    } catch (e) {\r\n      console.log(e);\r\n      return 'Cant get vouchers';\r\n    }\r\n  }\r\n\r\n  async requestVoucher(voucherRequestData: IVoucherRequest) {\r\n    try {\r\n      const result = await Parse.Cloud.run('requestVoucher', {voucherRequestData});\r\n      console.log('Result: ', result);\r\n      this.userStore.changeUserPoints(-voucherRequestData.voucher.points);\r\n      this.userStore.changeUserReservedPoints(voucherRequestData.voucher.points);\r\n      this.chartStore.updateChart();\r\n\r\n      // this.voucherRequestStore.addVoucherRequest(voucherRequestData);\r\n\r\n      Parse.User.current().fetch();\r\n      // const voucherRequestTable = Parse.Object.extend('Voucher_Request');\r\n      // const voucherRequest = new voucherRequestTable();\r\n      // await voucherRequest.save(voucherRequestData);\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n}\r\n","import {action, observable} from 'mobx-angular';\r\nimport {Injectable} from '@angular/core';\r\nimport {Chart} from \"chart.js\";\r\nimport {UserStore} from \"./user.store\";\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport default class ChartStore {\r\n  @observable chart: Chart = null;\r\n\r\n  constructor(private userStore: UserStore) {\r\n  }\r\n\r\n  @action\r\n  setChart(chart: Chart){\r\n    this.chart = chart;\r\n  }\r\n\r\n  @action\r\n  async updateChart(){\r\n    if(this.chart!==null){\r\n      this.chart.data.datasets[0].data = [this.userStore.user.points, this.userStore.user.reserved_points];\r\n      this.chart.update();\r\n    }\r\n  }\r\n\r\n\r\n}\r\n","import {action, observable} from 'mobx-angular';\r\nimport {Injectable} from '@angular/core';\r\nimport {IVoucher} from \"../model/voucher.model\";\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport default class VoucherStore {\r\n  @observable vouchers: IVoucher[] = [];\r\n  @observable selectedVoucher: IVoucher;\r\n\r\n  constructor() {\r\n    this.vouchers = [];\r\n  }\r\n\r\n  @action\r\n  async setVouchers(vouchers: IVoucher[]){\r\n    console.log('Setting vouchers: ', vouchers);\r\n    this.vouchers.push(...vouchers);\r\n  }\r\n\r\n  @action\r\n  setSelectedVoucher(voucher: IVoucher){\r\n    console.log('Setting voucher: ', voucher);\r\n    this.selectedVoucher = voucher;\r\n  }\r\n  @action\r\n  addVoucher(voucher: IVoucher){\r\n    this.vouchers.push(voucher);\r\n  }\r\n}\r\n","import {action, observable} from 'mobx-angular';\r\nimport {Injectable} from '@angular/core';\r\nimport {IVoucherRequest} from \"../model/voucher.model\";\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport default class VoucherRequestStore {\r\n  @observable voucherRequests: IVoucherRequest[] = [];\r\n\r\n  constructor() {\r\n    this.voucherRequests = [];\r\n  }\r\n\r\n  @action\r\n  async setVoucherRequests(voucherRequests: IVoucherRequest[]){\r\n    console.log('Setting voucher requests: ', voucherRequests);\r\n    this.voucherRequests.push(...voucherRequests);\r\n  }\r\n\r\n  @action\r\n  addVoucherRequest(voucherRequest: IVoucherRequest){\r\n    console.log('Setting voucher request: ', voucherRequest);\r\n    this.voucherRequests.unshift(voucherRequest);\r\n  }\r\n\r\n\r\n\r\n\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}