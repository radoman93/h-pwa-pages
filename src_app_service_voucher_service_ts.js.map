{"version":3,"file":"src_app_service_voucher_service_ts.js","mappings":"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","sources":["./src/app/service/voucher.service.ts","./src/app/store/chart.store.ts","./src/app/store/voucher.store.ts","./src/app/store/voucherRequest.store.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\r\nimport * as Parse from 'parse';\r\nimport VoucherStore from '../store/voucher.store';\r\nimport {ParseHelper} from '../helper/parse.helper';\r\nimport {IVoucher, IVoucherRequest, IVoucherRequestParse} from '../model/voucher.model';\r\nimport {UserStore} from \"../store/user.store\";\r\nimport {PaginationHelper} from \"../helper/pagination.helper\";\r\nimport ChartStore from \"../store/chart.store\";\r\nimport VoucherRequestStore from \"../store/voucherRequest.store\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class VoucherService {\r\n\r\n  constructor(private voucherRequestStore: VoucherRequestStore, private voucherStore: VoucherStore, private userStore: UserStore, private chartStore: ChartStore) {\r\n  }\r\n\r\n\r\n  async getSpecificVouchers(brandID: string) {\r\n    try {\r\n      // const query = new Parse.Query('Voucher');\r\n      // const results: any[] = await query.\r\n    } catch (e) {\r\n      console.log('Error: ', e);\r\n    }\r\n  }\r\n\r\n  async getAllVouchers() {\r\n    try {\r\n      const query = new Parse.Query('Voucher');\r\n      const results: any[] = await query.include('brand').findAll();\r\n      const vouchers: IVoucher[] = ParseHelper.arrayToJSON(results);\r\n      console.log('Got vouchers: ', vouchers);\r\n      for (let el of vouchers) {\r\n        if (!await PaginationHelper.checkExisting(el, this.voucherStore.vouchers)) {\r\n          this.voucherStore.addVoucher(el);\r\n        }\r\n      }\r\n      // await this.voucherStore.setVouchers(vouchers);\r\n    } catch (e) {\r\n      console.log(e);\r\n      return 'Cant get vouchers';\r\n    }\r\n  }\r\n\r\n  async requestVoucher(voucherRequestData: IVoucherRequest) {\r\n    try {\r\n      const result = await Parse.Cloud.run('requestVoucher', {voucherRequestData});\r\n      console.log('Result: ', result);\r\n      this.userStore.changeUserPoints(-voucherRequestData.voucher.points);\r\n      this.userStore.changeUserReservedPoints(voucherRequestData.voucher.points);\r\n      this.chartStore.updateChart();\r\n\r\n      // this.voucherRequestStore.addVoucherRequest(voucherRequestData);\r\n\r\n      Parse.User.current().fetch();\r\n      // const voucherRequestTable = Parse.Object.extend('Voucher_Request');\r\n      // const voucherRequest = new voucherRequestTable();\r\n      // await voucherRequest.save(voucherRequestData);\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n}\r\n","import {action, observable} from 'mobx-angular';\r\nimport {Injectable} from '@angular/core';\r\nimport {Chart} from \"chart.js\";\r\nimport {UserStore} from \"./user.store\";\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport default class ChartStore {\r\n  @observable chart: Chart = null;\r\n\r\n  constructor(private userStore: UserStore) {\r\n  }\r\n\r\n  @action\r\n  setChart(chart: Chart){\r\n    this.chart = chart;\r\n  }\r\n\r\n  @action\r\n  async updateChart(){\r\n    if(this.chart!==null){\r\n      this.chart.data.datasets[0].data = [this.userStore.user.points, this.userStore.user.reserved_points];\r\n      this.chart.update();\r\n    }\r\n  }\r\n\r\n\r\n}\r\n","import {action, observable} from 'mobx-angular';\r\nimport {Injectable} from '@angular/core';\r\nimport {IVoucher} from \"../model/voucher.model\";\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport default class VoucherStore {\r\n  @observable vouchers: IVoucher[] = [];\r\n  @observable selectedVoucher: IVoucher;\r\n\r\n  constructor() {\r\n    this.vouchers = [];\r\n  }\r\n\r\n  @action\r\n  async setVouchers(vouchers: IVoucher[]){\r\n    console.log('Setting vouchers: ', vouchers);\r\n    this.vouchers.push(...vouchers);\r\n  }\r\n\r\n  @action\r\n  setSelectedVoucher(voucher: IVoucher){\r\n    console.log('Setting voucher: ', voucher);\r\n    this.selectedVoucher = voucher;\r\n  }\r\n  @action\r\n  addVoucher(voucher: IVoucher){\r\n    this.vouchers.push(voucher);\r\n  }\r\n}\r\n","import {action, observable} from 'mobx-angular';\r\nimport {Injectable} from '@angular/core';\r\nimport {IVoucherRequest} from \"../model/voucher.model\";\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport default class VoucherRequestStore {\r\n  @observable voucherRequests: IVoucherRequest[] = [];\r\n\r\n  constructor() {\r\n    this.voucherRequests = [];\r\n  }\r\n\r\n  @action\r\n  async setVoucherRequests(voucherRequests: IVoucherRequest[]){\r\n    console.log('Setting voucher requests: ', voucherRequests);\r\n    this.voucherRequests.push(...voucherRequests);\r\n  }\r\n\r\n  @action\r\n  addVoucherRequest(voucherRequest: IVoucherRequest){\r\n    console.log('Setting voucher request: ', voucherRequest);\r\n    this.voucherRequests.unshift(voucherRequest);\r\n  }\r\n\r\n\r\n\r\n\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}