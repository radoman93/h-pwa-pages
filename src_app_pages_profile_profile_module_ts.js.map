{"version":3,"file":"src_app_pages_profile_profile_module_ts.js","mappings":"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","sources":["./src/app/pages/profile/profile-routing.module.ts","./src/app/pages/profile/profile.module.ts","./src/app/pages/profile/profile.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { ProfilePage } from './profile.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ProfilePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class ProfilePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { ProfilePageRoutingModule } from './profile-routing.module';\r\n\r\nimport { ProfilePage } from './profile.page';\r\nimport {SharedModule} from \"../../module/shared.module\";\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    ProfilePageRoutingModule,\r\n    ReactiveFormsModule,\r\n    SharedModule,\r\n  ],\r\n  declarations: [ProfilePage]\r\n})\r\nexport class ProfilePageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport * as Parse from 'parse';\r\nimport {IUser, IUserEdit, IUserRegisterAttributes} from '../../model/user.model';\r\nimport {ModalHelper} from '../../helper/modal.helper';\r\nimport {UserService} from '../../service/user.service';\r\nimport {UserStore} from '../../store/user.store';\r\nimport {FormBuilder, FormControl, Validators} from '@angular/forms';\r\nimport {PasswordValidation} from '../../validators/pw-validation';\r\nimport {SettingsStore} from '../../store/settings.store';\r\nimport {ParseHelper} from '../../helper/parse.helper';\r\n\r\n\r\n@Component({\r\n  selector: 'app-profile',\r\n  templateUrl: './profile.page.html',\r\n  styleUrls: ['./profile.page.scss'],\r\n})\r\nexport class ProfilePage implements OnInit {\r\n  user: IUser;\r\n  registerAttributes: IUserRegisterAttributes;\r\n  uploaded: boolean;\r\n  registrationForm = this.formBuilder.group({\r\n    firstName: new FormControl('', Validators.required),\r\n    lastName: new FormControl('', Validators.required),\r\n    country: new FormControl('', Validators.required),\r\n    shopBrand: new FormControl('', Validators.required),\r\n    city: new FormControl('', Validators.required),\r\n    shop: new FormControl('', Validators.required),\r\n    phoneNumber: new FormControl('', Validators.required),\r\n  });\r\n\r\n\r\n  constructor(public settingsStore: SettingsStore, public userStore: UserStore, public modalHelper: ModalHelper, private userService: UserService, private formBuilder: FormBuilder) {\r\n    this.user = Parse.User.current().toJSON() as unknown as IUser;\r\n    Parse.User.current().fetchWithInclude(['shop','city','country','shopBrand']).then(r=>{\r\n      this.loadUserData();\r\n    });\r\n  }\r\n\r\n  loadUserData(){\r\n    // @ts-ignore\r\n    this.registrationForm.setValue({\r\n      firstName: this.user.firstName,\r\n      lastName: this.user.lastName,\r\n      country: this.user.country.objectId,\r\n      city: this.user.city,\r\n      shop: this.user.shop,\r\n      shopBrand: this.user.shopBrand,\r\n      phoneNumber: this.user.phoneNumber\r\n    });\r\n  }\r\n\r\n  async openEditModal(){\r\n    await this.modalHelper.openEditModal();\r\n  }\r\n  async logout(){\r\n    await this.userService.logout();\r\n  }\r\n\r\n  async editUser(){\r\n    try {\r\n      this.uploaded = false;\r\n      const country: Parse.Object = ParseHelper.getParseObjectWithoutData('Country', this.registrationForm.value.country);\r\n      const shopBrand: Parse.Object = ParseHelper.getParseObjectWithoutData('Shop', this.registrationForm.value.shopBrand);\r\n\r\n      const registerAttributes: IUserRegisterAttributes = {\r\n        email: this.user.email,\r\n        firstName: this.registrationForm.value.firstName.trim(),\r\n        lastName: this.registrationForm.value.lastName.trim(),\r\n        country,\r\n        shopBrand,\r\n        city: this.registrationForm.value.city.trim(),\r\n        shop: this.registrationForm.value.shop.trim(),\r\n        phoneNumber: this.registrationForm.value.phoneNumber.trim()\r\n      };\r\n      const editUser: IUserEdit = {\r\n        newUser: registerAttributes,\r\n        user: Parse.User.current()\r\n      };\r\n      console.log('Sending data to request');\r\n      await this.userService.editUserRequest(editUser);\r\n      const delay = ms => new Promise(res => setTimeout(res, ms));\r\n      await delay(1000);\r\n      this.uploaded = true;\r\n    }catch (e) {\r\n      const delay = ms => new Promise(res => setTimeout(res, ms));\r\n      await delay(1000);\r\n      this.uploaded = true;\r\n      console.log('Error: ', e);\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  onCountryChange($event: any) {\r\n\r\n  }\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}